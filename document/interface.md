# 接口文档
> 日期：2016年 9月 26日 15点 10分

### 接口数据格式定义说明
C -> S(客户端到服务器)

S -> C(服务器到客户端)

### 资源的访问控制
* 静态资源
> 通过登录用户的session控制访问

* 服务接口
> 通过session验证[s]+sessionName
> 通过token验证[t]+tokenName+len
> 通过图片验证码验证[c]+codeName+len
> 通过邮件验证码验证[e]
> 不需要null验证[n]

### 接口格式
[
```
  {
    "describe":"",
    "name":"",
    "url":"/",
    "method":"",
    "security":[
      {"type":"","name":""}
    ],
    "arg":[
      {"name":""}
    ],
    "return":[
      {"type":"json","msg":{"code":1}}
    ]
  }
```
]

### 用户接口
登陆(未登录)
```
{
	name:/cyzm6/public/user/login,
	method:post,
    arg:[
        {name:email,type:string,max-len:128},
        {name:pwd,type:string,min-len:6,max-len:128},
        {name:code,type:string,length:6}
    ]
    return:[
        {code:-1}|
        {code:0}|
        {code:1}|
        {code:2}|
        {code:3}|
        {code:9}
    ]
}
```
注册(未登录)

```
{
    name:/cyzm6/public/user/register,
    method:post,
    arg:[
        {name:name,type:string,min-len:1,max-len:128},
        {name:pwd,type:string,min-len:6,max-len:128},
        {name:email,type:string},
        {name:age,type:int,range:0-150},
        {name:sex:,type:int,range:0-3},
        {name:code,type:string,length:6}
    ],
    return:[
        {code:-1}|
        {code:0}|
        {code:1}|
        {code:4}
    ]
}
```

```
  {
    "describe":"用户个人信息获取",
    "name":"myinfo",
    "url":"/suser/private/user/user/myinfo",
    "method":"post",
    "security":[
      {"type":"session","name":"user"}
    ],
    "arg":[],
    "return":[
      {"type":"json","msg":{"code":0}},
      {"type":"json","msg":{"code":1,"data":{
        {"_id" : ObjectId(""),"name":"","type":"","email":"","sex":,"age":,"regist":,"remark":"","login":,"socket":}
      }}}
    ]
  }
```

修改密码(登录)
```
{
    name:/suser/private/user/modifypwd,
    method:post,
    arg:[
        {name:oldpwd,type:string,min-len:6,max-len:128},
        {name:newpwd,type:string,min-len:6,max-len:128}
    ],
    return:[
        {code:-1}|
        {code:1}|
        {code:3}
    ]
}
```
更换邮箱(登录)
```
发送请求得到验证码
{
    name:/suser/private/user/modifyemail1,
    method:post,
    return:[
        {code:-1}|
        {code:1}|
        {code:5}|
        {code:7}
    ]
}
填写验证码，并发送新的邮箱
{
    name:/suser/e/private/user/modifyemail2,
    method:post,
    arg:[
        {name:email,type:string},
        {name:mailcode,type:string}
    ]，
    return:[
        {code:-1}|
        {code:1}|
        {code:10}
    ]
}
```
密码找回(未登录)
```
1.发送找回请求
{
    name:/cyzm6/public/user/findpwd1,
    method:post,
    arg:[
        {name:email,type:string},
        {name:code,type:string,len:6}
    ],
    return:[
        {code:-1}|
        {code:0}|
        {code:1}|
        {code:5}|
        {code:6}
    ]
}
2.成功后修改密码
{
    name:/smail/public/user/findpwd2,
    method:post,
    arg:[
        {name:newpwd,type:string,min-len:6,max-len:128},
        {name:code,type:string,len:6}
    ]
    return:[
        {code:-1}|
        {code:0}|
        {code:1}|
        {code:10}
    ]
}
```
---
修改个性签名(登录)
```
{
    name:/suser/private/user/modifysign,
    method:get,
    arg:[
        {name:words,type:string,min-len:1,max-len:128}
    ],
    return:[
        {code:-1}|
        {code:0}|
        {code:1}|
        {code:7}
    ]
}
```
修改用户名(登录)
```
{
    name:/suser/private/user/modifyname,
    method:get,
    arg:[
        {name:name,type:string,min-len:1,max-len:128}
    ],
    return:[
        {code:-1}|
        {code:0}|
        {code:1}|
        {code:7}
    ]
}
```
修改头像(登录)
```
{
    name:/suser/private/user/uploadhead,
    method:post,
    arg:[
        {name:head,type:base64-string,min-len=50,max-len:1024}
    ],
    return:[
        {code:-1}|
        {code:0}|
        {code:1}|
        {code:7}|
        {code:12}
    ]
}
```
修改年龄(登录)
```
{
    name:/suser/private/user/modifyage,
    method:get,
    arg:[
        {name:age,type:int,min:0,max:200}
    ],
    return:[
        {code:-1}|
        {code:0}|
        {code:1}
    ]
}
```
性别修改(登录)
```
{
    name:/suser/private/user/modifysex,
    method:get,
    arg:[
        {name:sex,type:int,min:0,max:2}
    ],
    return:[
        {code:-1}|
        {code:0}|
        {code:1}
    ]
}
```
---
添加好友(登录)
```
{
    name:/suser/private/friend/add,
    method:get,
    arg:[
        {name:fid,type:string}
    ],
    return:[
        {code:-1}|
        {code:0}|
        {code:1}|
        {code:2}|
        {code:11}
    ]
}
```
好友搜索(登录)
```
以昵称的搜索方式
{
    name:/suser/private/friend/searchname,
    method:get,
    arg:[
        {name:name,type:string}
    ],
    return:[
        {code:-1}|
        {code:0}|
        {code:1,data:[{id:"",name:"","remark":""}]}
    ]
}
以用户ID的搜索方式(登录)
{
    name:/suser/private/friend/searchid,
    method:get,
    arg:[
        {name:id,type:string}
    ],
    return:[
        {code:-1}|
        {code:0}|
        {"code":1,"data":{"_id":ObjectId(),"name":"","pwd":null,"type":1,"email":"","sex":0,"age":0,"regist":0,"remark":""}}
    ]
}
```
删除好友(登录)
```
{
    name:/suser/private/friend/delete,
    method:get,
    arg:[
        {name:id,type:string}
    ],
    return:[
        {code:-1}|
        {code:0}|
        {code:1}|
        {code:10}
    ]
}
```
备注的修改(登录)
```
{
    name:/suser/private/friend/modifyrm,
    method:get,
    arg:[
        {name:fid,type:string}
        {name:nickname,type:string}
    ],
    return:[
        {code:-1}|
        {code:0}|
        {code:1}|
        {code:10}
    ]
}
```
获取好友列表信息(登录)
```
{
    name:/suser/private/friend/getlist,
    method:post,
    arg:[],
    return:[
        {code:-1}|
        {code:0}|
        {code:1,data:[{"_id":ObjectId(""),"name":"sw","pwd":null,"type":"1","email":"","sex":0,"age":21,"regist":0,"remark":"","socket":null}]}|
        {code:10}
    ]
}
{
    "describe":"通过ID获取群信息",
    "name":"groupinfo",
    "url":"/suser/private/group/groupinfo",
    "method":"post",
    "security":[],
    "server":[
        {"type":"session","name":"user"}
    ],
    "arg":[
        {"type":"String","name":"id"}
    ],
    "return":[
        {"code":-1},
        {"code":1,"data":{"_id":ObjectId(),"name":"","remark":"","datetime":0,"owner":{"_id":ObjectId(),"name":"","pwd":null,"type":1,"email":"","sex":0,"age":1,"regist":0,"remark":null}}},
        {"code":10},
    ]
}
```
### 系统接口
{
    "describe":"6位验证码接口",
    "name":"cyzm6",
    "url":"/public/api/cyzm6",
    "method":"get",
    "security":[],
    "server":[
        {"type":"session","name":""}
    ],
    "arg":[],
    "return":[
        {"type":"image/jpeg"}
    ]
}
{
    "describe":"4位验证码接口",
    "name":"cyzm4",
    "url":"/public/api/cyzm4",
    "method":"get",
    "arg":[],
    "return":[
        {"type":"image/jpeg"}
    ]
}
{
    "describe":"获取sessionid",
    "name":"sessionid",
    "url":"/suser/sessionid",
    "method":"get",
    "arg":[],
    "return":[
        {"code":7},
        {"code":1,"id":""}
    ]
}

